<html>

  <head>
    <title>
      cvt_corn
    </title>
  </head>

  <body bgcolor="#EEEEEE" link="#CC0000" alink="#FF3300" vlink="#000055">

    <h1 align = "center">
      cvt_corn
    </h1>

    <hr>

    <p>
      <b>cvt_corn</b>,
      a MATLAB code which 
      studies a 2D model of the growth of a corn kernel.
    </p>

    <p>
      Scientists understand the basic physical laws that govern the
      chemical reactions involved in the growth of a cell.  However,
      they are still searching for models that can suggest the
      phenomena observed as a collection of cells grow into an organism.
      Simple observations are that the cells take on a convex
      polygonal shape, that neighboring cells share a flattened
      boundary, that the nucleus of each cell stays roughly in the
      center, that the growth rate of cells can vary in proportion
      to the distance from some growth center, and that the organism
      tends to have an outer layer of cells that form a boundary
      or skin.
    </p>

    <p>
      A suggested model comes from the Voronoi diagram.  The Voronoi diagram
      starts with a plane, and a set of points, and divides a finite
      portion of the plane
      by drawing a boundary line around each point, enclosing all the
      territory that is closest to it.  While the Voronoi diagram
      organizes the plane, there may be a great irregularity in the
      size and shape of the regions, and most points will not be
      centrally located in their regions.
    </p>

    <p>
      A variation of the Voronoi diagram is known as the Centroidal
      Voronoi Tessellation or CVT.  The CVT assumes that the points
      have some kind of tendency to move towards the center of their regions.
      If the points move, then the regions will change shape, which
      will impel the points to move a little more.  This dynamic process
      actually will come to a conclusion, in which every point is exactly
      in the center of its region, and the regions are all roughly the
      same size and shape.  The image of a CVT can strongly suggest
      a biological structure such as a slice through a honeycomb.
    </p>

    <p>
      Two modifications to the CVT idea help us to improve our simulation.
      By adding a weight function, we can allow a smooth variation in
      the size of the regions; in this case, we expect larger cells
      in the center of the corn kernel, and smaller ones as we go outward.
      It is also possible to modify the CVT idea so that some points, 
      however reluctantly, are pushed to form a smooth boundary, whereas
      in a pure CVT, no points would appear there.
    </p>

    <p>
      This means that we can try to adjust a CVT to model the development
      of a simple biological organism.  Although the CVT can handle
      problems in 3D, we will look at a simplified 2D case; we can imagine
      we are viewing a slice of a real object as it grows.  
    </p>

    <p>
      The program <i>cvt_corn.m</i> demonstrates some of these ideas
      by ``growing'' a simulated corn kernel, which starts out as a circular 
      area containing cells, randomly placed in the interior and on the
      boundary.  The program simulates growth by applying the CVT
      algorithm with a nonuniform density, adjusting the boundary
      layer, and also randomly adding new biological cells at each step.
      As the number of cells increase, the corn seed is also allowed
      to grow in size, while staying circular.
    </p>

    <p>
      Since we don't have much data to work with, we are free to choose
      such quantities as the nonuniformity function, the number and 
      initial placement of cells, the rate of growth.  What we are looking
      for is ``phenomenology'', that is, can our process make pictures
      that roughly correspond to what is seen in nature?
    </p>

    <p>
      Here are two photomicrographs of 
      <a href = "corn_radial.png">a radial slice</a>
      and <a href = "corn_transverse.png">a transverse slice</a> through a corn
      kernel.  These pictures were an inspiration for the study done here.
    </p>

    <p>
      The program models the corn kernel as a circle.  There is a layer of
      surface cells on the circumference of the circle, and a collection of
      interior cells within the circle.  Each cell is marked, that is, it 
      knows what kind of cell it is, and this marker is never changed.  
      Each cell is modeled by a single geometric point.  The extent of a 
      surface cell is the set of circumference points closer to it than to 
      any other circumference cell.  The extent of an interior cell is the 
      set of interior points closer to it than to any other interior cell.
    </p>

    <p>
      Cells may move.  Surface cells may move along the circumference.  Interior
      cells may move within the interior.
      We presume that the cells adjust their positions in accordance with the
      energy minimization principle.  Briefly, this means that each cell's
      preferred location is the centroid of its extent.   Surface cells may
      only move to the projection of their centroid on the circumference. 
    </p>

    <p>
      As a rough model of growth, once we have completed a CVT iteration,
      we may begin a new step by allowing cells to "bud".  Surface and 
      cells are each given a probability of budding.  We then compute
      which cells have budded.  Surface cells can give birth to another 
      surface cell, or to an interior cell.  Once the new cells have been 
      created, and positioned very close to their parents, another CVT 
      iteration is carried out.
    </p>

    <p>
      The program uses some parameters which the user can monitor or set:
      <ul>
        <li>
          <b>ALG</b>, the CVT update algorithm:
          <ul>
            <li>
              1 = update circle + disk together.
            </li>
            <li>
              2 = update circle only, then update disk only.
            </li>
            <li>
              3 = update circle only, then update circle + disk together.
            </li>
          </ul>
        </li>
        <li>
          <b>NB</b>, the number of points on boundary;
        </li>
        <li>
          <b>NI</b>, number of point in interior;
        </li>
        <li>
          <b>NP</b>, total number of points;
        </li>
        <li>
          <b>NS</b>, number of sample points for Lloyd's algorithm;
        </li>
        <li>
          <b>PR_BUD</b>, probability that a boundary point will create a bud;
        </li>
        <li>
          <b>PR_BUD_ANGULAR</b>, probability that boundary bud is constrained 
          to the boundary;
        </li>
        <li>
          <b>R</b>, the radius of the circle;
        </li>
        <li>
          <b>SEED</b>, the initial random number seed;
        </li>
      </ul>
    </p>

    <h3 align = "center">
      Licensing:
    </h3>
 
    <p>
      The computer code and data files described and made available on this web page 
      are distributed under
      <a href = "https://www.gnu.org/licenses/lgpl-3.0.en.html">the GNU LGPL license.</a>
    </p>

    <h3 align = "center">
      Languages
    </h3>

    <p>
      <b>cvt_corn</b> is available in
      <a href = "../../m_src/cvt_corn/cvt_corn.html">a MATLAB version</a>.
    </p>

    <h3 align = "center">
      Related Data and Programs:
    </h3>

    <p>
      <a href = "../../m_src/cvt/cvt.html">
      cvt</a>,
      a MATLAB code which
      can compute a CVT.
    </p>

    <p>
      <a href = "../../m_src/cvt_1d_lloyd/cvt_1d_lloyd.html">
      cvt_1d_lloyd</a>,
      a MATLAB code which 
      computes an N-point Centroidal Voronoi Tessellation (CVT)
      within the interval [0,1], under a uniform density.
    </p>

    <p>
      <a href = "../../m_src/cvt_1d_nonuniform/cvt_1d_nonuniform.html">
      cvt_1d_nonuniform</a>,
      a MATLAB code which
      constructs a CVT in one dimension, under a nonuniform density function.
    </p>

    <p>
      <a href = "../../m_src/cvt_1d_sampling/cvt_1d_sampling.html">
      cvt_1d_sampling</a>,
      a MATLAB code which 
      computes an N-point Centroidal Voronoi Tessellation (CVT)
      within the interval [0,1], under a uniform density, 
      using sampling to estimate the Voronoi regions.
    </p>

    <p>
      <a href = "../../m_src/cvt_2d_sampling/cvt_2d_sampling.html">
      cvt_2d_sampling</a>,
      a MATLAB code which
      computes an N-point Centroidal Voronoi Tessellation (CVT)
      within the unit square [0,1]x[0,1], under a uniform density,
      using sampling to estimate the Voronoi regions.
    </p>

    <p>
      <a href = "../../m_src/cvt_circle_uniform/cvt_circle_uniform.html">
      cvt_circle_uniform</a>,
      a MATLAB code which
      calculates a Centroidal Voronoi Tessellation (CVT) over a circle
      with uniform density.
    </p>

    <p>
      <a href = "../../m_src/cvt_corn_test/cvt_corn_test.html">
      cvt_corn_test</a>
    </p>

    <p>
      <a href = "../../m_src/cvt_corn_movie/cvt_corn_movie.html">
      cvt_corn_movie</a>,
      a MATLAB code which 
      makes a movie in which the growth of a corn kernel is simulated
      using a Centroidal Voronoi Tessellation (CVT).
    </p>

    <p>
      <a href = "../../m_src/cvt_square_nonuniform/cvt_square_nonuniform.html">
      cvt_square_nonuniform</a>,
      a MATLAB code which
      iteratively calculates a Centroidal Voronoi Tessellation (CVT)
      over a square, with a nonuniform density.
    </p>

    <p>
      <a href = "../../m_src/cvtm_1d/cvtm_1d.html">
      cvtm_1d</a>,
      a MATLAB code which 
      estimates a mirror-periodic centroidal Voronoi Tessellation (CVTM) in the 
      periodic interval [0,1], using a version of Lloyd's iteration.
    </p>

    <p>
      <a href = "../../m_src/cvtp_1d/cvtp_1d.html">
      cvtp_1d</a>,
      a MATLAB code which 
      estimates a periodic centroidal Voronoi Tessellation (CVTP) in the 
      periodic interval [0,1], using a version of Lloyd's iteration.
    </p>

    <p>
      <a href = "../../m_src/florida_cvt_geo/florida_cvt_geo.html">
      florida_cvt_geo</a>,
      a MATLAB code which
      explore the creation of a centroidal Voronoi Tessellation (CVT) of
      the state of Florida, based solely on geometric considerations.
    </p>

    <p>
      <a href = "../../m_src/florida_cvt_pop/florida_cvt_pop.html">
      florida_cvt_pop</a>,
      a MATLAB code which
      explore the creation of a centroidal Voronoi Tessellation (CVT) of
      the state of Florida, based on population density.
    </p>

    <p>
      <a href = "../../m_src/usa_cvt_geo/usa_cvt_geo.html">
      usa_cvt_geo</a>,
      MATLAB codes which
      explore the creation of a centroidal Voronoi Tessellation (CVT) of
      the United States, based solely on geometric considerations.
    </p>

    <h3 align = "center">
      Reference:
    </h3>

    <p>
      <ol>
        <li>
          Franz Aurenhammer,<br>
          Voronoi diagrams - 
          a study of a fundamental geometric data structure,<br>
          ACM Computing Surveys,<br>
          Volume 23, Number 3, pages 345-405, September 1991.
        </li>
        <li>
          Qiang Du, Vance Faber, Max Gunzburger,<br>
          Centroidal Voronoi Tessellations: Applications and Algorithms,<br>
          SIAM Review,<br>
          Volume 41, 1999, pages 637-676.
        </li>
        <li>
          Lili Ju, Qiang Du, Max Gunzburger,<br>
          Probabilistic methods for centroidal Voronoi tessellations
          and their parallel implementations,<br>
          Parallel Computing,<br>
          Volume 28, 2002, pages 1477-1500.
        </li>
      </ol>
    </p>

    <h3 align = "center">
      Source Code:
    </h3>

    <p>
      <ul>
        <li>
          <a href = "bud.m">bud.m</a>, 
          carries out the budding process.
        </li>
        <li>
          <a href = "bud_angular.m">bud_angular.m</a>, 
          sets the coordinates for an "angular" bud.
        </li>
        <li>
          <a href = "bud_radial.m">bud_radial.m</a>, 
          sets the coordinates for a "radial" bud.
        </li>
        <li>
          <a href = "cvt_circle.m">cvt_circle.m</a>, 
          applies the CVT algorithm to points on a circle.
        </li>
        <li>
          <a href = "cvt_circle_step.m">cvt_circle_step.m</a>, 
          applies one step of the CVT algorithm to points on a circle.
        </li>
        <li>
          <a href = "cvt_corn.m">cvt_corn.m</a>, 
          the main program, which carries out the simulation
          of the growth of a kernel of corn.
        </li>
        <li>
          <a href = "cvt_disk.m">cvt_disk.m</a>, 
          computes a CVT in the disk.
        </li>
        <li>
          <a href = "cvt_disk_interior.m">cvt_disk_interior.m</a>, 
          computes a CVT in the disk interior.
        </li>
        <li>
          <a href = "cvt_display.m">cvt_display.m</a>, 
          displays the estimated CVT diagram.
        </li>
        <li>
          <a href = "disk_sample_nonuniform.m">disk_sample_nonuniform.m</a>, 
          nonuniformly samples the disk of radius R.
        </li>
        <li>
          <a href = "disk_sample_uniform.m">disk_sample_uniform.m</a>, 
          uniformly samples the disk of radius R.
        </li>
        <li>
          <a href = "find_closest.m">find_closest.m</a>, 
          finds the nearest G point to each S point.
        </li>
        <li>
          <a href = "parameter_initialize.m">parameter_initialize.m</a>, 
          sets the initial values of parameters.
        </li>
        <li>
          <a href = "parameter_print.m">parameter_print.m</a>, 
          prints the current values of parameters
        </li>
        <li>
          <a href = "parameter_set.m">parameter_set.m</a>, 
          allows the user to reset parameter values.
        </li>
        <li>
          <a href = "radial_growth.m">radial_growth.m</a>, 
          simulates the radial expansion of the region.
        </li>
        <li>
          <a href = "state_display.m">state_display.m</a>, 
          displays the current state.
        </li>
        <li>
          <a href = "state_initialize.m">state_initialize.m</a>, 
          initializes the state.
        </li>
      </ul>
    </p>

    <p>
      The following images are snapshots from a run of the program
      with the default parameter settings:
      <ul>
        <li>
          <a href = "initial.png">initial.png</a>, 
          the initial random state, with 40 boundary points and 60 interior points.
        </li>
        <li>
          <a href = "step00.png">step00.png</a>, 
          the CVT at step 0.
        </li>
        <li>
          <a href = "step01.png">step01.png</a>, 
          the CVT at step 1.
        </li>
        <li>
          <a href = "step02.png">step02.png</a>, 
          the CVT at step 2.
        </li>
        <li>
          <a href = "step03.png">step03.png</a>, 
          the CVT at step 3.
        </li>
        <li>
          <a href = "step04.png">step04.png</a>, 
          the CVT at step 4
        </li>
        <li>
          <a href = "step05.png">step05.png</a>, 
          the CVT at step 5.
        </li>
        <li>
          <a href = "step10.png">step10.png</a>, 
          the CVT at step 10.
        </li>
        <li>
          <a href = "step20.png">step20.png</a>, 
          the CVT at step 20.
        </li>
        <li>
          <a href = "step30.png">step30.png</a>, 
          the CVT at step 30.
        </li>
      </ul>
    </p>

    <hr>

    <i>
      Last revised on 12 April 2019.
    </i>

    <!-- John Burkardt -->

  </body>

</html>
