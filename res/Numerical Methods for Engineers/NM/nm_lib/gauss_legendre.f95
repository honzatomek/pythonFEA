SUBROUTINE gauss_legendre(samp,wt)
!---Provides Weights and Sampling Points for Gauss-Legendre---
 USE precision; IMPLICIT NONE
 REAL(iwp),INTENT(OUT)::samp(:,:),wt(:); INTEGER::nsp,ndim
 nsp=UBOUND(samp,1); ndim=UBOUND(samp,2)
 SELECT CASE(ndim)
 CASE(1)
 SELECT CASE(nsp)
   CASE(1)
     samp(1,1)=  0.0_iwp
     wt(1)  =    2.0_iwp
   CASE(2)
     samp(1,1)= -0.57735026918962576449_iwp
     samp(2,1)=  0.57735026918962576449_iwp
     wt(1)=      1.0_iwp
     wt(2)=      1.0_iwp
   CASE(3)
     samp(1,1)= -0.77459666924148337704_iwp
     samp(2,1)=  0.0_iwp
     samp(3,1)=  0.77459666924148337704_iwp
     wt(1)=      0.55555555555555555556_iwp
     wt(2)=      0.88888888888888888889_iwp
     wt(3)=      0.55555555555555555556_iwp
   CASE(4)
     samp(1,1)= -0.86113631159405257524_iwp
     samp(2,1)= -0.33998104358485626481_iwp
     samp(3,1)=  0.33998104358485626481_iwp
     samp(4,1)=  0.86113631159405257524_iwp
     wt(1)=      0.34785484513745385737_iwp
     wt(2)=      0.65214515486254614271_iwp
     wt(3)=      0.65214515486254614271_iwp
     wt(4)=      0.34785484513745385737_iwp
   CASE(5)
     samp(1,1)= -0.90617984593866399282_iwp
     samp(2,1)= -0.53846931010568309105_iwp
     samp(3,1)=  0.0_iwp
     samp(4,1)=  0.53846931010568309105_iwp
     samp(5,1)=  0.90617984593866399282_iwp
     wt(1)=      0.23692688505618908751_iwp
     wt(2)=      0.47862867049936646804_iwp
     wt(3)=      0.56888888888888888889_iwp
     wt(4)=      0.47862867049936646804_iwp
     wt(5)=      0.23692688505618908751_iwp   
   CASE DEFAULT
     WRITE(*,*)"Wrong number of integrating points"
   END SELECT
 CASE(2)
   SELECT CASE(nsp)
   CASE(1)
     samp(1,1)=  0.0_iwp 
     samp(1,2)=  0.0_iwp
     wt(1)=      4.0_iwp
   CASE(4)
     samp(1,1)= -0.57735026918962576449_iwp
     samp(2,1)=  0.57735026918962576449_iwp
     samp(3,1)= -0.57735026918962576449_iwp
     samp(4,1)=  0.57735026918962576449_iwp
     samp(1,2)= -0.57735026918962576449_iwp
     samp(2,2)= -0.57735026918962576449_iwp
     samp(3,2)=  0.57735026918962576449_iwp
     samp(4,2)=  0.57735026918962576449_iwp
     wt(1)=      1.0_iwp
     wt(2)=      1.0_iwp
     wt(3)=      1.0_iwp
     wt(4)=      1.0_iwp
   CASE(9)
     samp(1,1)= -0.77459666924148337704_iwp
     samp(2,1)=  0.0_iwp
     samp(3,1)=  0.77459666924148337704_iwp
     samp(4,1)= -0.77459666924148337704_iwp
     samp(5,1)=  0.0_iwp
     samp(6,1)=  0.77459666924148337704_iwp
     samp(7,1)= -0.77459666924148337704_iwp
     samp(8,1)=  0.0_iwp
     samp(9,1)=  0.77459666924148337704_iwp
     samp(1,2)= -0.77459666924148337704_iwp
     samp(2,2)= -0.77459666924148337704_iwp
     samp(3,2)= -0.77459666924148337704_iwp
     samp(4,2)=  0.0_iwp
     samp(5,2)=  0.0_iwp
     samp(6,2)=  0.0_iwp
     samp(7,2)=  0.77459666924148337704_iwp
     samp(8,2)=  0.77459666924148337704_iwp
     samp(9,2)=  0.77459666924148337704_iwp
     wt(1) =     0.30864197530864197531_iwp
     wt(2) =     0.49382716049382716049_iwp
     wt(3) =     0.30864197530864197531_iwp
     wt(4) =     0.49382716049382716049_iwp
     wt(5) =     0.79012345679012345679_iwp
     wt(6) =     0.49382716049382716049_iwp
     wt(7) =     0.30864197530864197531_iwp
     wt(8) =     0.49382716049382716049_iwp
     wt(9) =     0.30864197530864197531_iwp
   CASE(16)
     samp(1,1) =-0.86113631159405257524_iwp
     samp(2,1) =-0.33998104358485626481_iwp
     samp(3,1) = 0.33998104358485626481_iwp
     samp(4,1) = 0.86113631159405257524_iwp
     samp(5,1) =-0.86113631159405257524_iwp
     samp(6,1) =-0.33998104358485626481_iwp
     samp(7,1) = 0.33998104358485626481_iwp
     samp(8,1) = 0.86113631159405257524_iwp
     samp(9,1) =-0.86113631159405257524_iwp
     samp(10,1)=-0.33998104358485626481_iwp
     samp(11,1)= 0.33998104358485626481_iwp
     samp(12,1)= 0.86113631159405257524_iwp
     samp(13,1)=-0.86113631159405257524_iwp
     samp(14,1)=-0.33998104358485626481_iwp
     samp(15,1)= 0.33998104358485626481_iwp
     samp(16,1)= 0.86113631159405257524_iwp
     samp(1,2) =-0.86113631159405257524_iwp
     samp(2,2) =-0.86113631159405257524_iwp
     samp(3,2) =-0.86113631159405257524_iwp
     samp(4,2) =-0.86113631159405257524_iwp
     samp(5,2) =-0.33998104358485626481_iwp
     samp(6,2) =-0.33998104358485626481_iwp
     samp(7,2) =-0.33998104358485626481_iwp
     samp(8,2) =-0.33998104358485626481_iwp
     samp(9,2) = 0.33998104358485626481_iwp
     samp(10,2)= 0.33998104358485626481_iwp
     samp(11,2)= 0.33998104358485626481_iwp
     samp(12,2)= 0.33998104358485626481_iwp
     samp(13,2)= 0.86113631159405257524_iwp
     samp(14,2)= 0.86113631159405257524_iwp
     samp(15,2)= 0.86113631159405257524_iwp
     samp(16,2)= 0.86113631159405257524_iwp
     wt(1)=      0.12100299328560200551_iwp
     wt(2)=      0.22685185185185185185_iwp
     wt(3)=      0.22685185185185185185_iwp
     wt(4)=      0.12100299328560200551_iwp
     wt(5)=      0.22685185185185185185_iwp
     wt(6)=      0.42529330301069429082_iwp
     wt(7)=      0.42529330301069429082_iwp
     wt(8)=      0.22685185185185185185_iwp
     wt(9)=      0.22685185185185185185_iwp
     wt(10)=     0.42529330301069429082_iwp
     wt(11)=     0.42529330301069429082_iwp
     wt(12)=     0.22685185185185185185_iwp
     wt(13)=     0.12100299328560200551_iwp
     wt(14)=     0.22685185185185185185_iwp
     wt(15)=     0.22685185185185185185_iwp
     wt(16)=     0.12100299328560200551_iwp
   CASE(25)
     samp(1,1) =-0.90617984593866399282_iwp
     samp(2,1) =-0.53846931010568309105_iwp
     samp(3,1) = 0.0_iwp
     samp(4,1) = 0.53846931010568309105_iwp
     samp(5,1) = 0.90617984593866399282_iwp
     samp(6,1) =-0.90617984593866399282_iwp
     samp(7,1) =-0.53846931010568309105_iwp
     samp(8,1) = 0.0_iwp
     samp(9,1) = 0.53846931010568309105_iwp
     samp(10,1)= 0.90617984593866399282_iwp
     samp(11,1)=-0.90617984593866399282_iwp
     samp(12,1)=-0.53846931010568309105_iwp
     samp(13,1)= 0.0_iwp
     samp(14,1)= 0.53846931010568309105_iwp
     samp(15,1)= 0.90617984593866399282_iwp
     samp(16,1)=-0.90617984593866399282_iwp
     samp(17,1)=-0.53846931010568309105_iwp
     samp(18,1)= 0.0_iwp
     samp(19,1)= 0.53846931010568309105_iwp
     samp(20,1)= 0.90617984593866399282_iwp
     samp(21,1)=-0.90617984593866399282_iwp
     samp(22,1)=-0.53846931010568309105_iwp
     samp(23,1)= 0.0_iwp
     samp(24,1)= 0.53846931010568309105_iwp
     samp(25,1)= 0.90617984593866399282_iwp
     samp(1,2) =-0.90617984593866399282_iwp
     samp(2,2) =-0.90617984593866399282_iwp
     samp(3,2) =-0.90617984593866399282_iwp
     samp(4,2) =-0.90617984593866399282_iwp
     samp(5,2) =-0.90617984593866399282_iwp
     samp(6,2) =-0.53846931010568309105_iwp
     samp(7,2) =-0.53846931010568309105_iwp
     samp(8,2) =-0.53846931010568309105_iwp
     samp(9,2) =-0.53846931010568309105_iwp
     samp(10,2)=-0.53846931010568309105_iwp
     samp(11,2)= 0.0_iwp
     samp(12,2)= 0.0_iwp
     samp(13,2)= 0.0_iwp
     samp(14,2)= 0.0_iwp
     samp(15,2)= 0.0_iwp
     samp(16,2)= 0.53846931010568309105_iwp
     samp(17,2)= 0.53846931010568309105_iwp
     samp(18,2)= 0.53846931010568309105_iwp
     samp(19,2)= 0.53846931010568309105_iwp
     samp(20,2)= 0.53846931010568309105_iwp
     samp(21,2)= 0.90617984593866399282_iwp
     samp(22,2)= 0.90617984593866399282_iwp
     samp(23,2)= 0.90617984593866399282_iwp
     samp(24,2)= 0.90617984593866399282_iwp
     samp(25,2)= 0.90617984593866399282_iwp
     wt(1) =     0.05613434886242863595_iwp
     wt(2) =     0.1134_iwp
     wt(3) =     0.13478507238752090312_iwp
     wt(4) =     0.1134_iwp
     wt(5) =     0.05613434886242863595_iwp
     wt(6) =     0.1134_iwp
     wt(7) =     0.22908540422399111713_iwp
     wt(8) =     0.27228653255075070182_iwp
     wt(9) =     0.22908540422399111713_iwp
     wt(10)=     0.1134_iwp
     wt(11)=     0.13478507238752090305_iwp 
     wt(12)=     0.27228653255075070171_iwp 
     wt(13)=     0.32363456790123456757_iwp 
     wt(14)=     0.27228653255075070171_iwp 
     wt(15)=     0.13478507238752090305_iwp 
     wt(16)=     0.1134_iwp
     wt(17)=     0.22908540422399111713_iwp
     wt(18)=     0.27228653255075070182_iwp
     wt(19)=     0.22908540422399111713_iwp
     wt(20)=     0.1134_iwp
     wt(21)=     0.05613434886242863595_iwp
     wt(22)=     0.1134_iwp
     wt(23)=     0.13478507238752090312_iwp
     wt(24)=     0.1134_iwp
     wt(25)=     0.05613434886242863595_iwp
   CASE DEFAULT
     WRITE(*,*)"Wrong number of integrating points" 
   END SELECT
 CASE(3)
   SELECT CASE(nsp)
   CASE(1)
     samp(1,1)=  0.0_iwp 
     samp(1,2)=  0.0_iwp
     samp(1,3)=  0.0_iwp
     wt(1)=      8.0_iwp
   CASE(8)   
     samp(1,1)=-0.57735026918962576449_iwp
     samp(2,1)= 0.57735026918962576449_iwp
     samp(3,1)=-0.57735026918962576449_iwp
     samp(4,1)= 0.57735026918962576449_iwp
     samp(5,1)=-0.57735026918962576449_iwp
     samp(6,1)= 0.57735026918962576449_iwp
     samp(7,1)=-0.57735026918962576449_iwp
     samp(8,1)= 0.57735026918962576449_iwp
     samp(1,2)=-0.57735026918962576449_iwp
     samp(2,2)=-0.57735026918962576449_iwp
     samp(3,2)=-0.57735026918962576449_iwp
     samp(4,2)=-0.57735026918962576449_iwp
     samp(5,2)= 0.57735026918962576449_iwp
     samp(6,2)= 0.57735026918962576449_iwp
     samp(7,2)= 0.57735026918962576449_iwp
     samp(8,2)= 0.57735026918962576449_iwp
     samp(1,3)=-0.57735026918962576449_iwp
     samp(2,3)=-0.57735026918962576449_iwp
     samp(3,3)= 0.57735026918962576449_iwp
     samp(4,3)= 0.57735026918962576449_iwp
     samp(5,3)=-0.57735026918962576449_iwp
     samp(6,3)=-0.57735026918962576449_iwp
     samp(7,3)= 0.57735026918962576449_iwp
     samp(8,3)= 0.57735026918962576449_iwp
     wt(1)=     1.0_iwp                                         
     wt(2)=     1.0_iwp                                         
     wt(3)=     1.0_iwp                                         
     wt(4)=     1.0_iwp                                         
     wt(5)=     1.0_iwp                                         
     wt(6)=     1.0_iwp                                         
     wt(7)=     1.0_iwp                                         
     wt(8)=     1.0_iwp                                         
   CASE(27)
     samp(1,1)= -0.77459666924148337704_iwp
     samp(2,1)=  0.0_iwp
     samp(3,1)=  0.77459666924148337704_iwp
     samp(4,1)= -0.77459666924148337704_iwp
     samp(5,1)=  0.0_iwp
     samp(6,1)=  0.77459666924148337704_iwp
     samp(7,1)= -0.77459666924148337704_iwp
     samp(8,1)=  0.0_iwp
     samp(9,1)=  0.77459666924148337704_iwp
     samp(10,1)=-0.77459666924148337704_iwp
     samp(11,1)= 0.0_iwp
     samp(12,1)= 0.77459666924148337704_iwp
     samp(13,1)=-0.77459666924148337704_iwp
     samp(14,1)= 0.0_iwp
     samp(15,1)= 0.77459666924148337704_iwp
     samp(16,1)=-0.77459666924148337704_iwp
     samp(17,1)= 0.0_iwp
     samp(18,1)= 0.77459666924148337704_iwp
     samp(19,1)=-0.77459666924148337704_iwp
     samp(20,1)= 0.0_iwp
     samp(21,1)= 0.77459666924148337704_iwp
     samp(22,1)=-0.77459666924148337704_iwp
     samp(23,1)= 0.0_iwp
     samp(24,1)= 0.77459666924148337704_iwp
     samp(25,1)=-0.77459666924148337704_iwp
     samp(26,1)= 0.0_iwp
     samp(27,1)= 0.77459666924148337704_iwp
     samp(1,2)= -0.77459666924148337704_iwp
     samp(2,2)= -0.77459666924148337704_iwp
     samp(3,2)= -0.77459666924148337704_iwp
     samp(4,2)= -0.77459666924148337704_iwp
     samp(5,2)= -0.77459666924148337704_iwp
     samp(6,2)= -0.77459666924148337704_iwp
     samp(7,2)= -0.77459666924148337704_iwp
     samp(8,2)= -0.77459666924148337704_iwp
     samp(9,2)= -0.77459666924148337704_iwp
     samp(10,2)= 0.0_iwp
     samp(11,2)= 0.0_iwp
     samp(12,2)= 0.0_iwp
     samp(13,2)= 0.0_iwp
     samp(14,2)= 0.0_iwp
     samp(15,2)= 0.0_iwp
     samp(16,2)= 0.0_iwp
     samp(17,2)= 0.0_iwp
     samp(18,2)= 0.0_iwp
     samp(19,2)= 0.77459666924148337704_iwp
     samp(20,2)= 0.77459666924148337704_iwp
     samp(21,2)= 0.77459666924148337704_iwp
     samp(22,2)= 0.77459666924148337704_iwp
     samp(23,2)= 0.77459666924148337704_iwp
     samp(24,2)= 0.77459666924148337704_iwp
     samp(25,2)= 0.77459666924148337704_iwp
     samp(26,2)= 0.77459666924148337704_iwp
     samp(27,2)= 0.77459666924148337704_iwp
     samp(1,3)= -0.77459666924148337704_iwp
     samp(2,3)= -0.77459666924148337704_iwp
     samp(3,3)= -0.77459666924148337704_iwp
     samp(4,3)=  0.0_iwp
     samp(5,3)=  0.0_iwp
     samp(6,3)=  0.0_iwp
     samp(7,3)=  0.77459666924148337704_iwp
     samp(8,3)=  0.77459666924148337704_iwp
     samp(9,3)=  0.77459666924148337704_iwp
     samp(10,3)=-0.77459666924148337704_iwp
     samp(11,3)=-0.77459666924148337704_iwp
     samp(12,3)=-0.77459666924148337704_iwp
     samp(13,3)= 0.0_iwp
     samp(14,3)= 0.0_iwp
     samp(15,3)= 0.0_iwp
     samp(16,3)= 0.77459666924148337704_iwp
     samp(17,3)= 0.77459666924148337704_iwp
     samp(18,3)= 0.77459666924148337704_iwp
     samp(19,3)=-0.77459666924148337704_iwp
     samp(20,3)=-0.77459666924148337704_iwp
     samp(21,3)=-0.77459666924148337704_iwp
     samp(22,3)= 0.0_iwp
     samp(23,3)= 0.0_iwp
     samp(24,3)= 0.0_iwp
     samp(25,3)= 0.77459666924148337704_iwp
     samp(26,3)= 0.77459666924148337704_iwp
     samp(27,3)= 0.77459666924148337704_iwp
     wt(1)     = 0.17146776406035665295_iwp
     wt(2)     = 0.27434842249657064472_iwp
     wt(3)     = 0.17146776406035665295_iwp
     wt(4)     = 0.27434842249657064472_iwp
     wt(5)     = 0.43895747599451303155_iwp
     wt(6)     = 0.27434842249657064472_iwp
     wt(7)     = 0.17146776406035665295_iwp
     wt(8)     = 0.27434842249657064472_iwp
     wt(9)     = 0.17146776406035665295_iwp
     wt(10)    = 0.27434842249657064472_iwp
     wt(11)    = 0.43895747599451303155_iwp
     wt(12)    = 0.27434842249657064472_iwp
     wt(13)    = 0.43895747599451303155_iwp
     wt(14)    = 0.70233196159122085048_iwp
     wt(15)    = 0.43895747599451303155_iwp
     wt(16)    = 0.27434842249657064472_iwp
     wt(17)    = 0.43895747599451303155_iwp
     wt(18)    = 0.27434842249657064472_iwp
     wt(19)    = 0.17146776406035665295_iwp
     wt(20)    = 0.27434842249657064472_iwp
     wt(21)    = 0.17146776406035665295_iwp
     wt(22)    = 0.27434842249657064472_iwp
     wt(23)    = 0.43895747599451303155_iwp
     wt(24)    = 0.27434842249657064472_iwp
     wt(25)    = 0.17146776406035665295_iwp
     wt(26)    = 0.27434842249657064472_iwp
     wt(27)    = 0.17146776406035665295_iwp
   CASE DEFAULT
     WRITE(*,*)"Wrong number of integrating points" 
   END SELECT
 CASE DEFAULT
   WRITE(*,*)"Not a valid dimension" 
 END SELECT
RETURN
END SUBROUTINE gauss_legendre
